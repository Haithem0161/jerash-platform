---
phase: 02-animation-framework
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/animations/MotionProvider.tsx
  - src/components/animations/variants.ts
  - src/components/animations/FadeIn.tsx
  - src/components/animations/StaggerContainer.tsx
  - src/components/animations/index.ts
  - src/components/providers/index.tsx
autonomous: true

must_haves:
  truths:
    - "Scroll-triggered elements fade in and move up when scrolling into view"
    - "Staggered animations work on groups of elements with sequential delays"
    - "Animations automatically disabled when prefers-reduced-motion is enabled"
    - "All animations only use transform/opacity for 60fps performance"
  artifacts:
    - path: "src/components/animations/MotionProvider.tsx"
      provides: "Global MotionConfig with reducedMotion='user'"
      exports: ["MotionProvider"]
    - path: "src/components/animations/variants.ts"
      provides: "Shared animation variant definitions"
      exports: ["defaultTransition", "fadeUpVariants", "staggerContainerVariants"]
    - path: "src/components/animations/FadeIn.tsx"
      provides: "Scroll-triggered fade-up reveal component"
      exports: ["FadeIn"]
    - path: "src/components/animations/StaggerContainer.tsx"
      provides: "Parent container for staggered child animations"
      exports: ["StaggerContainer", "StaggerItem"]
    - path: "src/components/animations/index.ts"
      provides: "Barrel export for all animation components"
  key_links:
    - from: "src/components/providers/index.tsx"
      to: "src/components/animations/MotionProvider.tsx"
      via: "MotionProvider wrapping children"
      pattern: "<MotionProvider>"
    - from: "src/components/animations/FadeIn.tsx"
      to: "src/components/animations/variants.ts"
      via: "imports variant definitions"
      pattern: "import.*from.*variants"
---

<objective>
Create reusable animation infrastructure components for scroll-triggered reveals and staggered animations, with global reduced motion support via MotionConfig.

Purpose: Downstream phases (Homepage, Services, HSE) will use these components for consistent, performant, accessible animations throughout the site.

Output: Animation wrapper components (FadeIn, StaggerContainer) and a MotionProvider integrated into the app's provider stack.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-animation-framework/02-CONTEXT.md
@.planning/phases/02-animation-framework/02-RESEARCH.md
@FRAMER-MOTION.md
@src/hooks/useMediaQuery.ts
@src/lib/i18n.ts
@src/components/providers/index.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create animation variants and MotionProvider</name>
  <files>
    src/components/animations/variants.ts
    src/components/animations/MotionProvider.tsx
    src/components/animations/index.ts
    src/components/providers/index.tsx
  </files>
  <action>
Create `src/components/animations/` directory and build foundational animation files:

**variants.ts:**
- Define `defaultTransition` (duration: 0.3s, ease: 'easeOut') per CONTEXT.md decisions
- Define `fastTransition` (duration: 0.2s) for page transitions
- Define `instantTransition` (duration: 0.1s) for hover responses
- Define `fadeUpVariants` with hidden (opacity: 0, y: 20) and visible states
- Define `staggerContainerVariants` with staggerChildren: 0.1, delayChildren: 0.05
- Define `staggerItemVariants` matching fadeUpVariants for children
- Export all as named exports with proper TypeScript types (Variants, Transition from motion/react)

**MotionProvider.tsx:**
- Import MotionConfig from 'motion/react'
- Create MotionProvider component accepting children prop
- Wrap children in `<MotionConfig reducedMotion="user" transition={defaultTransition}>`
- This globally handles ANIM-04 (reduced motion) - transforms become instant, opacity still animates

**index.ts:**
- Create barrel export file for all animation components
- Export MotionProvider and all variants

**providers/index.tsx:**
- Import MotionProvider from '@/components/animations'
- Add MotionProvider as outermost wrapper (before HelmetProvider) in Providers component
- This ensures all Motion components respect reduced motion globally

Import motion components from 'motion/react' (the v12 recommended import path).
  </action>
  <verify>
    pnpm build succeeds with no TypeScript errors
    grep -r "MotionProvider" src/components/providers/index.tsx shows integration
    grep -r "reducedMotion" src/components/animations/MotionProvider.tsx confirms setting
  </verify>
  <done>
    variants.ts exports transition and variant definitions
    MotionProvider wraps app with MotionConfig reducedMotion="user"
    All animations will automatically respect prefers-reduced-motion system preference
  </done>
</task>

<task type="auto">
  <name>Task 2: Create FadeIn and StaggerContainer components</name>
  <files>
    src/components/animations/FadeIn.tsx
    src/components/animations/StaggerContainer.tsx
    src/components/animations/index.ts
  </files>
  <action>
**FadeIn.tsx:**
- Import motion from 'motion/react', useTranslation from 'react-i18next', isRTL from '@/lib/i18n'
- Create FadeIn component with props: children, className?, delay?, direction? ('up' | 'down' | 'left' | 'right', default 'up')
- Implement RTL-aware direction handling:
  - 'up': y offset positive (20px)
  - 'down': y offset negative (-20px)
  - 'left': x offset flipped for RTL (rtl ? 20 : -20)
  - 'right': x offset flipped for RTL (rtl ? -20 : 20)
- Use motion.div with:
  - initial={{ opacity: 0, ...offset }}
  - whileInView={{ opacity: 1, x: 0, y: 0 }}
  - viewport={{ once: true, amount: 0.2 }} (per CONTEXT.md: animate once, trigger at 20% visible)
  - transition={{ duration: 0.3, delay, ease: 'easeOut' }}
- Pass through className prop

**StaggerContainer.tsx:**
- Import motion from 'motion/react'
- Import staggerContainerVariants, staggerItemVariants from './variants'
- Create StaggerContainer component with props: children, className?
- Use motion.div with:
  - variants={staggerContainerVariants}
  - initial="hidden"
  - whileInView="visible"
  - viewport={{ once: true, amount: 0.2 }}
- Create StaggerItem component with props: children, className?
- Use motion.div with variants={staggerItemVariants} (inherits animation state from parent)
- Export both StaggerContainer and StaggerItem

**index.ts:**
- Add FadeIn, StaggerContainer, StaggerItem to barrel exports

Per ANIM-05: Only opacity and transform (x, y) are animated - no width, height, or layout properties.
  </action>
  <verify>
    pnpm build succeeds with no TypeScript errors
    grep -r "whileInView" src/components/animations/FadeIn.tsx confirms scroll trigger
    grep -r "staggerChildren" src/components/animations/variants.ts confirms stagger setup
  </verify>
  <done>
    FadeIn component provides RTL-aware scroll reveal with configurable direction
    StaggerContainer/StaggerItem provide grouped staggered animations
    Components ready for use in Homepage sections (Phase 3)
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `pnpm build` succeeds with no errors
2. `pnpm lint` passes (or only pre-existing warnings)
3. Animation components export correctly: `grep -r "export" src/components/animations/index.ts`
4. MotionProvider integrated: `grep -r "MotionProvider" src/components/providers/index.tsx`
</verification>

<success_criteria>
- [ ] MotionProvider wraps entire app with reducedMotion="user"
- [ ] variants.ts contains reusable transition and variant definitions
- [ ] FadeIn component triggers on scroll with RTL-aware directional support
- [ ] StaggerContainer/StaggerItem enable grouped staggered animations
- [ ] All components only animate opacity and transform (no layout properties)
- [ ] Build succeeds with proper TypeScript types
</success_criteria>

<output>
After completion, create `.planning/phases/02-animation-framework/02-01-SUMMARY.md`
</output>
